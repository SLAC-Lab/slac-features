<?php
/**
 * @file
 * Code for the SLAC News feature.
 */

include_once 'slac_news.features.inc';

//Add more view modes for Media formatting.
function slac_news_entity_info_alter(&$entity_info) {
  $entity_info['file']['view modes']['crop_crop_news_landscape'] = array(
    'label' => t('Crop News Landscape'),
    'custom settings' => TRUE,
  );
}

/*function slac_news_preprocess_node(&$variables, $hook) {
  dpm($variables);

  if (!$variables['teaser'] && $variables['node']->type != 'slac_news') {
    return;
  }

  $variables['unpublished'] = (!$variables['status']) ? TRUE : FALSE;

  // Unset links like "add comment", "read more" etc. for teaser.
  if ($variables['node']->type == 'slac_news' && $variables['teaser'] == TRUE && isset($variables['content']['links'])) {
    unset($variables['content']['links']);
  }
  elseif ($variables['node']->type == 'slac_news' && isset($variables['content']['links']['slac_news'])) {
    unset($variables['content']['links']['slac_news']);
  }

  // Add pubdate to submitted variable.
  $variables['pubdate'] = '<time pubdate datetime="' . format_date($variables['node']->created, 'custom', 'c') . '">' . $variables['date'] . '</time>';
  if ($variables['node']->type == 'slac_news' && drupal_get_profile() == 'slac_people' && $variables['display_submitted']) {
    $variables['pubdate'] = '<time pubdate datetime="' . format_date($variables['node']->created, 'custom', 'c') . '">' . format_date($variables['created'], 'custom', 'l, F j, Y') . '</time>';
    $variables['submitted'] = t('Posted on !datetime', array('!datetime' => $variables['pubdate']));
  }
  elseif ($variables['display_submitted']) {
    $variables['submitted'] = t('Submitted by !username on !datetime', array('!username' => $variables['name'], '!datetime' => $variables['pubdate']));
  }

  // Add a class for the view mode.
  if (!$variables['teaser']) {
    $variables['classes_array'][] = 'view-mode-' . $variables['view_mode'];
  }

  // Add a class to show node is authored by current user.
  if ($variables['uid'] && $variables['uid'] == $GLOBALS['user']->uid) {
    $variables['classes_array'][] = 'node-by-viewer';
  }

  $variables['title_attributes_array']['class'][] = 'node__title';
  $variables['title_attributes_array']['class'][] = 'node-title';
}*/